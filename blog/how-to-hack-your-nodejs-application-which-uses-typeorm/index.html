<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta name="description" content="Among Node.js developers there is a constant struggle to choose the best ORM library. I most often choose TypeORM in my projects and althoughÂ I think it is the best ORM, it has its drawbacks. In today&#x27;s article, I&#x27;ll show you how you can stupidly make a huge mistake and let your application be hacked by accidentally granting root access. It may sound spicy, but it is! ðŸŒ¶" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="ðŸš¨ How to hack your Node.js application (which uses TypeORM)? â€” Adrian Pietrzak: Software Engineering Blog" data-gatsby-head="true"/><meta name="twitter:description" content="Among Node.js developers there is a constant struggle to choose the best ORM library. I most often choose TypeORM in my projects and althoughÂ I think it is the best ORM, it has its drawbacks. In today&#x27;s article, I&#x27;ll show you how you can stupidly make a huge mistake and let your application be hacked by accidentally granting root access. It may sound spicy, but it is! ðŸŒ¶" data-gatsby-head="true"/><meta name="og:title" content="ðŸš¨ How to hack your Node.js application (which uses TypeORM)? â€” Adrian Pietrzak: Software Engineering Blog" data-gatsby-head="true"/><meta name="og:type" content="website" data-gatsby-head="true"/><meta name="og:description" content="Among Node.js developers there is a constant struggle to choose the best ORM library. I most often choose TypeORM in my projects and althoughÂ I think it is the best ORM, it has its drawbacks. In today&#x27;s article, I&#x27;ll show you how you can stupidly make a huge mistake and let your application be hacked by accidentally granting root access. It may sound spicy, but it is! ðŸŒ¶" data-gatsby-head="true"/><meta name="image" content="https://pietrzakadrian.com/static/6e4d9e5ea69d6824f2b97db97a897aa2/thumbnail.jpeg" data-gatsby-head="true"/><meta name="og:image" content="https://pietrzakadrian.com/static/6e4d9e5ea69d6824f2b97db97a897aa2/thumbnail.jpeg" data-gatsby-head="true"/><meta name="twitter:image" content="https://pietrzakadrian.com/static/6e4d9e5ea69d6824f2b97db97a897aa2/thumbnail.jpeg" data-gatsby-head="true"/><meta name="theme-color" content="hsl(31, 92%, 62%)"/><style data-href="/styles.9e3cc3c7ab3c2b310a05.css" data-identity="gatsby-global-css">:after,:before,:root{--color-white:#fff;--color-primary:#2c964a;--color-secondary:#2ea34f;--color-prism-background:#e2e5e9;--color-typographic-base-font:#242933;--color-typographic-link-p-font:#2ea34f;--color-typographic-link-s-font:#2c964a;--color-page-border:#e2e5e9;--color-page-background:#fff;--color-sidebar-border:#e2e5e9;--color-sidebar-border-fade:#fff;--color-contacts-border:#e2e5e9;--color-button-border:#e2e5e9;--color-button-color:#242933;--color-theme-switcher:#3f485a;--color-theme-switcher-hover:#2c964a;--color-tag-silver:#f5f7fa;--color-tag-silver-hover:#e6e6e6;--color-tag-silver-text:#242933;--color-input-border:#e2e5e9}.dark :after,.dark :before,:root.dark{--color-white:#fff;--color-primary:#548fc9;--color-secondary:#4082c4;--color-prism-background:#13161b;--color-typographic-base-font:#fff;--color-typographic-link-p-font:#4082c4;--color-typographic-link-s-font:#548fc9;--color-page-border:#3f485a;--color-page-background:#242933;--color-sidebar-border:#3f485a;--color-sidebar-border-fade:#242933;--color-contacts-border:#3f485a;--color-button-border:#3f485a;--color-button-color:#fff;--color-theme-switcher:#e2e5e9;--color-theme-switcher-hover:#4082c4;--color-tag-silver:#13161b;--color-tag-silver-hover:#3f485a;--color-tag-silver-text:#fff;--color-input-border:#13161b}html{font-size:100}body,html{overscroll-behavior-y:none}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;background:var(--color-page-background);color:var(--color-typographic-base-font);font-family:Gotham-Book,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:16px;line-height:1.625;margin:0 0 0 calc(100vw - 100%);text-rendering:optimizelegibility}h1,h2,h3,h4,h5,h6{font-family:Butler,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1{font-size:40px;line-height:52px;margin-bottom:26px;margin-top:104px}h2{font-size:27px;line-height:39px}h2,h3{margin-bottom:13px;margin-top:52px}h3{font-size:22px;line-height:26px}h4{font-size:19.2px;margin-top:39px}h4,h5{line-height:26px;margin-bottom:13px}h5,h6{font-size:16px;margin-top:65px}h6{line-height:26px;margin-bottom:13px}img{max-width:100%}hr,img{border:0;display:block}hr{margin:20px auto;text-align:center;width:100px}hr,hr:before{color:var(--color-typographic-base-font)}hr:before{content:"â¦  â¦  â¦";font-size:15px}a{color:var(--color-typographic-link-p-font);text-decoration:none}a:active,a:focus,a:hover{color:var(--color-typographic-link-s-font)}b,strong{font-weight:600}ul{list-style:square;margin-bottom:26px}ul li{margin-bottom:10px;padding:0 5px}p{line-height:26px;margin-bottom:26px}blockquote{box-shadow:inset 3px 0 0 0 var(--color-typographic-base-font);font-style:italic;margin-left:0;padding-left:26px;text-align:left}figure{display:block;height:auto;width:100%}figcaption{color:var(--color-typographic-base-font);font-size:14px;font-style:italic;line-height:19.5px;margin-bottom:0;margin-top:6.5px;text-align:center}button{background-color:transparent}button,input{border-width:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;line-height:inherit;padding:0}input:focus{outline:none}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:310px;padding:0 26px}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Fira Code,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:14px;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2e3440}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#636f88}.token.punctuation{color:#81a1c1}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#81a1c1}.token.number{color:#b48ead}.token.boolean{color:#81a1c1}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a3be8c}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#81a1c1}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#88c0d0}.token.keyword{color:#81a1c1}.token.important,.token.regex{color:#ebcb8b}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@font-face{font-display:swap;font-family:Gotham-Book;font-style:normal;font-weight:400;src:local("Gotham-Book"),url(/static/Gotham-Book-207b1f58e0df329a118662e5e3d7500b.eot?#iefix) format("embedded-opentype"),url(/static/Gotham-Book-b39f02e9da64e0412f2091961423b8a3.woff2) format("woff2"),url(/static/Gotham-Book-e872be4db2fd5c800fd8d1b9d0372fc9.woff) format("woff"),url(/static/Gotham-Book-4c2cf6d6bc07b328e8d00fc4b8c70ff9.ttf) format("truetype"),url(/static/Gotham-Book-827308a1a798e3fe077d466f9c1ad461.svg#Gotham-Book) format("svg")}@font-face{font-display:swap;font-family:Butler;font-style:normal;font-weight:400;src:local("Butler"),url(/static/Butler-4a42f1a5ba360aad73c4e68c45a9d538.eot?#iefix) format("embedded-opentype"),url(/static/Butler-99c7b1a6053c62da9427902eaab58690.woff2) format("woff2"),url(/static/Butler-7704cc6b567d92ede0f67d6060f8f5c3.woff) format("woff"),url(/static/Butler-86d94a8a10eba000cff7120d06fe9312.ttf) format("truetype"),url(/static/Butler-0b1942017c6ffdc0d629c82f0a6d2077.svg#Butler) format("svg")}.Button-module--button--b1113,.Button-module--link--ce317{display:flex;justify-content:center}.Button-module--button--b1113{align-items:center;background-color:var(--color-secondary);color:var(--color-white);font-weight:600;padding:10px 15px;text-align:center;transition:background-color .2s ease}.Button-module--button--b1113:hover{background-color:var(--color-primary);color:#fff;cursor:pointer}.Collaboration-module--collaboration--77306 .Collaboration-module--button--1a15e{line-height:1;min-height:50px}.Tags-module--tags--18589{margin-bottom:13px}.Tags-module--tags--18589 .Tags-module--list--82ae6{list-style:none;margin-top:0;padding:0}.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015{display:inline-block;margin:6.5px 0;padding:0 6.5px 0 0}@media screen and (min-width:685px){.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015:first-child{margin-left:0;padding-left:0}}.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015 .Tags-module--button--421f7{align-items:center;background-color:var(--color-tag-silver);border:none;border-radius:20px;color:var(--color-tag-silver-text);display:flex;font-size:12px;height:26px;line-height:0;padding:0 13px;text-decoration:none;transition:background .1s ease}.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015 .Tags-module--button--421f7:hover{background-color:var(--color-tag-silver-hover)}.Layout-module--layout--2c933{margin-left:auto;margin-right:auto;max-width:1070px}.Layout-module--layout--2c933:before{content:"";display:table}.Layout-module--layout--2c933:after{clear:both;content:"";display:table}.Feed-module--feed--a6204 .Feed-module--item--c7a63{margin-bottom:32.5px}.Feed-module--feed--a6204 .Feed-module--item--c7a63:last-child{margin-bottom:13px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f{font-size:27px;line-height:39px;margin-bottom:3.9px;margin-top:0}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b{color:var(--color-typographic-base-font)}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b:hover{border-bottom:1px solid var(--color-typographic-base-font);color:var(--color-typographic-base-font)}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--description--57348{-webkit-box-orient:vertical;-webkit-line-clamp:4;display:-webkit-box;font-size:16px;line-height:26px;margin-bottom:19.5px;margin-top:0;overflow:hidden}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--bottom--dd480{align-items:center;display:flex}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--bottom--dd480 small{align-items:center;color:#7f8ba4;display:flex;height:26px;white-space:nowrap}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--bottom--dd480 .Feed-module--tags--75a26 div,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--bottom--dd480 .Feed-module--tags--75a26 li,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--bottom--dd480 .Feed-module--tags--75a26 ul{margin:0}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--time--72864{color:#7f8ba4;font-size:14px;font-weight:600}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--divider--81a18{color:#7f8ba4;margin:0 6.5px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 small{color:#7f8ba4;font-size:14px;font-weight:600}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b{color:var(--color-secondary);font-size:14px;font-weight:600;text-transform:uppercase}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b:hover{color:#4082c4}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e{color:var(--color-primary);font-size:16px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e:hover{border-bottom:1px solid var(--color-primary);color:var(--color-primary)}.Page-module--page--24e03{margin-bottom:52px}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:26px 19.5px 0}.Page-module--page--24e03 a{font-weight:600}.Page-module--page--24e03 .Page-module--title--90338{font-size:40px;font-weight:600;line-height:52px;margin-bottom:37.7px;margin-top:0}.Page-module--page--24e03 .Page-module--body--561c4{font-size:16px;line-height:26px;margin:0 0 26px}@media screen and (min-width:685px){.Page-module--page--24e03{width:calc(58.275% - 12.5px)}.Page-module--page--24e03:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--24e03:last-child{margin-right:0}.Page-module--page--24e03:nth-child(12n){float:right;margin-right:0}.Page-module--page--24e03:nth-child(12n+1){clear:both}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:32.5px 19.5px 0}}@media screen and (min-width:960px){.Page-module--page--24e03{width:calc(66.6% - 10px)}.Page-module--page--24e03:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--24e03:last-child{margin-right:0}.Page-module--page--24e03:nth-child(3n){float:right;margin-right:0}.Page-module--page--24e03:nth-child(3n+1){clear:both}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:39px 26px 0}}.Pagination-module--pagination--d61cb{display:flex;margin-top:52px}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b{text-align:left;width:50%}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d{color:var(--color-secondary);font-size:26px;font-weight:700}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d:focus,.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d:hover{color:var(--color-primary)}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d.Pagination-module--disable--7e105{color:#3f485a;pointer-events:none}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8{text-align:right;width:50%}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff{color:var(--color-secondary);font-size:26px;font-weight:700}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff:focus,.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff:hover{color:var(--color-primary)}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff.Pagination-module--disable--7e105{color:#3f485a;pointer-events:none}.Partners-module--partners--ab904 .Partners-module--parent--8e140{grid-column-gap:25px;grid-row-gap:0;display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr}.Partners-module--partners--ab904 .Partners-module--parent--8e140 .Partners-module--item--02c3b{align-items:center;display:flex;margin-bottom:0}.Related-module--related--75a7f .Related-module--header--4fb3a{margin-top:0}.Meta-module--meta--dae0a{color:#7f8ba4;display:flex;font-size:14px;font-weight:600}.Meta-module--meta--dae0a p{margin:0}.Meta-module--meta--dae0a span{margin:0 6px}.ThemeSwitcher-module--themeSwitcher--8a77f{--color:var(--color-theme-switcher)}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b{align-items:center;background:transparent;border:0;cursor:pointer;display:flex;justify-content:center;outline:0}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b svg{stroke:var(--color);pointer-events:none;transition:stroke .4s}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b:hover{--color:var(--color-theme-switcher-hover)}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--moon--10537{stroke-dasharray:0 1px;opacity:0;transition:stroke-dasharray .2s ease-in,opacity .4s ease-in}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--sun--2163a{stroke-dasharray:1px 1px;opacity:1;transition:stroke-dasharray .2s ease-in,opacity .4s ease-in}.ThemeSwitcher-module--themeSwitcher--8a77f.ThemeSwitcher-module--dark--6db0c .ThemeSwitcher-module--moon--10537{stroke-dasharray:1px 1px;opacity:1}.ThemeSwitcher-module--themeSwitcher--8a77f.ThemeSwitcher-module--dark--6db0c .ThemeSwitcher-module--sun--2163a{stroke-dasharray:0 1px;opacity:0}.Author-module--author--1c58d{align-items:center;display:flex;justify-content:space-between;line-height:26px;margin-bottom:39px;margin-top:13px;max-width:640px}.Author-module--author--1c58d .Author-module--photo--b037c{background-clip:padding-box;border-radius:50%;display:inline-block;height:50px;margin-bottom:0;margin-right:13px;width:50px}.Author-module--author--1c58d .Author-module--photo--b037c img{border-radius:50%}.Author-module--author--1c58d p,.Author-module--author--1c58d span,.Author-module--author--1c58d strong{line-height:1}.Author-module--author--1c58d .Author-module--information--20ba9{align-items:center;display:flex}.Author-module--author--1c58d .Author-module--information--20ba9 .Author-module--wrapper--5b181{display:flex;flex-direction:column;gap:5px}@media screen and (min-width:685px){.Author-module--author--1c58d{margin-left:auto;margin-right:auto}}.Content-module--content--80d58{margin:0 auto;max-width:945px;padding:0}.Content-module--content--80d58 .Content-module--title--09504{font-size:32px;font-weight:600;line-height:42.9px;margin:0 auto;max-width:640px;text-align:left}.Content-module--content--80d58 h1{font-size:28.8px;margin-top:26px}.Content-module--content--80d58 h2{font-size:24px}.Content-module--content--80d58 .Content-module--body--726c2 figure{margin-bottom:26px}.Content-module--content--80d58 .Content-module--body--726c2 figure blockquote{font-style:italic;margin-top:0;padding:26px 0}.Content-module--content--80d58 .Content-module--body--726c2 figure blockquote p{font-size:26.9072px;line-height:39px;margin-bottom:26px;margin-top:0;max-width:640px}.Content-module--content--80d58 .Content-module--body--726c2 a{text-decoration:underline}.Content-module--content--80d58 .Content-module--body--726c2 *{margin-left:auto;margin-right:auto;max-width:640px}.Content-module--content--80d58 .Content-module--body--726c2 h2>a{visibility:hidden}.Content-module--content--80d58 .Content-module--body--726c2 h2>a>svg{fill:var(--color-typographic-base-font)}.Content-module--content--80d58 .Content-module--body--726c2 img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--80d58{padding:0}.Content-module--content--80d58 .Content-module--title--09504{font-size:48px;line-height:58.5px;margin-bottom:0;margin-top:0}.Content-module--content--80d58 .Content-module--body--726c2,.Content-module--content--80d58 .Content-module--body--726c2 p{font-size:18px;line-height:29.25px;margin-bottom:29.25px}.Content-module--content--80d58 .Content-module--body--726c2 h2>a{padding-right:13px;visibility:unset}}.Copyright-module--copyright--766ee{color:#7f8ba4;font-size:14px}.Post-module--post--3a994 .Post-module--content--3c6e5{margin:0 auto}.Post-module--post--3a994 .Post-module--footer--f8705{margin:0;max-width:640px;padding:0}.Post-module--post--3a994 .Post-module--comments--d3b99{margin:0 auto;max-width:640px;padding:0!important}@media screen and (min-width:960px){.Post-module--post--3a994 .Post-module--footer--f8705{padding:0}}.Author-module--author--cbd31 .Author-module--photo--9787b{background-clip:padding-box;border-radius:50%;display:inline-block;height:75px;margin-bottom:0;width:75px}.Author-module--author--cbd31 .Author-module--photo--9787b img{border-radius:50%}.Author-module--author--cbd31 .Author-module--title--cf7e5{font-family:Gotham-Book,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:18px;font-weight:600;line-height:29.25px;margin:0}.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17,.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17:focus,.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17:hover{color:var(--color-typographic-base-font)}.Author-module--author--cbd31 .Author-module--subtitle--86ec5{color:#7f8ba4;line-height:26px;margin-bottom:26px}.Author-module--author--cbd31 .Author-module--titleContainer--4f576{align-items:center;display:flex;justify-content:space-between;margin:13px 0}.Icon-module--icon--1d7da{fill:currentcolor;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;speak:none;stroke:currentcolor;stroke-width:0;display:inline-block;font-style:normal;font-variant:normal;font-weight:400;height:1.5em;line-height:1em;text-align:center;text-transform:none;width:1.5em}.Contacts-module--contacts--09178{margin-bottom:26px}.Contacts-module--contacts--09178 .Contacts-module--list--9670b{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;margin:0;max-width:150px;padding:0}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0{align-content:center;align-items:center;display:flex;height:40px;justify-content:center;line-height:40px;margin:9.1px;padding:0;text-align:center}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0:nth-child(3n+1){margin-left:0}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0{border:0;color:var(--color-typographic-base-font);cursor:pointer;display:flex;transition:color .2s ease}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0:focus,.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0:hover{color:var(--color-typographic-link-p-font)}.Menu-module--menu--113a9{margin-bottom:26px}.Menu-module--menu--113a9 .Menu-module--list--e1ae3{list-style:none;margin:0;padding:0}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679{margin:13px 0;padding:0}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02{border:0;color:var(--color-typographic-base-font);font-size:16px;font-weight:400}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02:focus,.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02:hover{border-bottom:1px solid var(--color-primary);color:var(--color-primary)}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02.Menu-module--active--6cb74{border-bottom:1px solid var(--color-typographic-base-font);color:var(--color-typographic-base-font);font-weight:600}.Sidebar-module--sidebar--1bfa1{position:-webkit-sticky;position:sticky;width:100%}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:26px 19.5px 0;position:relative}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0:after{background:var(--color-sidebar-border);background:linear-gradient(to bottom,var(--color-sidebar-border) 0,var(--color-sidebar-border) 48%,var(--color-sidebar-border-fade) 100%)}@media screen and (min-width:685px){.Sidebar-module--sidebar--1bfa1{top:0;width:calc(41.625% - 17.5px)}.Sidebar-module--sidebar--1bfa1:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--1bfa1:last-child{margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(12n){float:right;margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(12n+1){clear:both}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:32.5px 19.5px 0}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0:after{bottom:0;content:"";height:540px;position:absolute;right:-10px;top:30px;width:1px}}@media screen and (min-width:960px){.Sidebar-module--sidebar--1bfa1{width:calc(33.3% - 20px)}.Sidebar-module--sidebar--1bfa1:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--1bfa1:last-child{margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(3n){float:right;margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(3n+1){clear:both}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:39px}}</style><title data-gatsby-head="true">ðŸš¨ How to hack your Node.js application (which uses TypeORM)? â€” Adrian Pietrzak: Software Engineering Blog</title><link rel="alternate" type="application/rss+xml" title="Adrian Pietrzak" href="/blog/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-205649365-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-205649365-1', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=44654e347188ff02bbe25c28926e9968" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=44654e347188ff02bbe25c28926e9968"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=44654e347188ff02bbe25c28926e9968"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script></head><body><script>
          void function() {
            var cachedMode;

            try {
              var preferredTheme = JSON.parse(localStorage.getItem('diesel:theme-atom'));

              if (preferredTheme && preferredTheme.mode) {
                cachedMode = preferredTheme.mode;
              }
            } catch (err) { }

            function setTheme(newTheme) {
              document.documentElement.className = newTheme;
            }

            var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

            setTheme(cachedMode || (darkQuery.matches ? 'dark' : 'light'));
          }()
        </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--2c933"><div class="Sidebar-module--sidebar--1bfa1"><div class="Sidebar-module--inner--344d0"><div class="Author-module--author--cbd31"><a href="/blog"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained Author-module--photo--9787b"><div style="max-width:960px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;960&#x27; width=&#x27;960&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/44654e347188ff02bbe25c28926e9968/7234b/photo.avif 240w,/static/44654e347188ff02bbe25c28926e9968/0f4b9/photo.avif 480w,/static/44654e347188ff02bbe25c28926e9968/c42ce/photo.avif 960w" sizes="(min-width: 960px) 960px, 100vw"/><source type="image/webp" data-srcset="/static/44654e347188ff02bbe25c28926e9968/8d565/photo.webp 240w,/static/44654e347188ff02bbe25c28926e9968/21b1a/photo.webp 480w,/static/44654e347188ff02bbe25c28926e9968/d6f60/photo.webp 960w" sizes="(min-width: 960px) 960px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 960px) 960px, 100vw" decoding="async" loading="lazy" data-src="/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png" data-srcset="/static/44654e347188ff02bbe25c28926e9968/87351/photo.png 240w,/static/44654e347188ff02bbe25c28926e9968/ec333/photo.png 480w,/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png 960w" alt="Adrian Pietrzak"/></picture><noscript><picture><source type="image/avif" srcSet="/static/44654e347188ff02bbe25c28926e9968/7234b/photo.avif 240w,/static/44654e347188ff02bbe25c28926e9968/0f4b9/photo.avif 480w,/static/44654e347188ff02bbe25c28926e9968/c42ce/photo.avif 960w" sizes="(min-width: 960px) 960px, 100vw"/><source type="image/webp" srcSet="/static/44654e347188ff02bbe25c28926e9968/8d565/photo.webp 240w,/static/44654e347188ff02bbe25c28926e9968/21b1a/photo.webp 480w,/static/44654e347188ff02bbe25c28926e9968/d6f60/photo.webp 960w" sizes="(min-width: 960px) 960px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 960px) 960px, 100vw" decoding="async" loading="lazy" src="/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png" srcSet="/static/44654e347188ff02bbe25c28926e9968/87351/photo.png 240w,/static/44654e347188ff02bbe25c28926e9968/ec333/photo.png 480w,/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png 960w" alt="Adrian Pietrzak"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a><div class="Author-module--titleContainer--4f576"><h2 class="Author-module--title--cf7e5"><a class="Author-module--link--09c17" href="/blog">Adrian Pietrzak</a></h2></div><p class="Author-module--subtitle--86ec5">Software Engineer from Poland. Mostly Node.js, React and React Native.</p></div><nav class="Menu-module--menu--113a9"><ul class="Menu-module--list--e1ae3"><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/blog">Articles</a></li><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/portrait">Portrait</a></li><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/tools">Tools</a></li><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/certifications">Certifications</a></li><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/collaboration">Collaboration âœ¨</a></li><li class="Menu-module--item--8b679"><a class="Menu-module--link--a6f02" href="/privacy-policy">Privacy policy</a></li></ul></nav><div class="Contacts-module--contacts--09178"><ul class="Contacts-module--list--9670b"><li class="Contacts-module--item--f9cb0"><span class="Contacts-module--link--de1e0"><svg class="Icon-module--icon--1d7da" viewBox="0 0 29 30"><title>email</title><path d="M26 23.5v-12c-0.328 0.375-0.688 0.719-1.078 1.031-2.234 1.719-4.484 3.469-6.656 5.281-1.172 0.984-2.625 2.188-4.25 2.188h-0.031c-1.625 0-3.078-1.203-4.25-2.188-2.172-1.813-4.422-3.563-6.656-5.281-0.391-0.313-0.75-0.656-1.078-1.031v12c0 0.266 0.234 0.5 0.5 0.5h23c0.266 0 0.5-0.234 0.5-0.5zM26 7.078c0-0.391 0.094-1.078-0.5-1.078h-23c-0.266 0-0.5 0.234-0.5 0.5 0 1.781 0.891 3.328 2.297 4.438 2.094 1.641 4.188 3.297 6.266 4.953 0.828 0.672 2.328 2.109 3.422 2.109h0.031c1.094 0 2.594-1.437 3.422-2.109 2.078-1.656 4.172-3.313 6.266-4.953 1.016-0.797 2.297-2.531 2.297-3.859zM28 6.5v17c0 1.375-1.125 2.5-2.5 2.5h-23c-1.375 0-2.5-1.125-2.5-2.5v-17c0-1.375 1.125-2.5 2.5-2.5h23c1.375 0 2.5 1.125 2.5 2.5z"></path></svg></span></li><li class="Contacts-module--item--f9cb0"><a class="Contacts-module--link--de1e0" href="https://github.com/pietrzakadrian" target="_blank" rel="noopener noreferrer"><svg class="Icon-module--icon--1d7da" viewBox="0 0 24 24"><title>github</title><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></li><li class="Contacts-module--item--f9cb0"><a class="Contacts-module--link--de1e0" href="https://www.twitter.com/pietrzakadrian" target="_blank" rel="noopener noreferrer"><svg class="Icon-module--icon--1d7da" viewBox="0 0 24 24"><title>twitter</title><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a></li></ul></div></div></div><div class="Page-module--page--24e03"><div class="Page-module--inner--4b31d"><div class="Page-module--body--561c4"><div class="Post-module--post--3a994"><div class="Post-module--content--3c6e5"><div class="Content-module--content--80d58"><h1 class="Content-module--title--09504">ðŸš¨ How to hack your Node.js application (which uses TypeORM)?</h1><div class="Author-module--author--1c58d"><div class="Author-module--information--20ba9"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained Author-module--photo--b037c"><div style="max-width:960px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;960&#x27; width=&#x27;960&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/44654e347188ff02bbe25c28926e9968/7234b/photo.avif 240w,/static/44654e347188ff02bbe25c28926e9968/0f4b9/photo.avif 480w,/static/44654e347188ff02bbe25c28926e9968/c42ce/photo.avif 960w" sizes="(min-width: 960px) 960px, 100vw"/><source type="image/webp" data-srcset="/static/44654e347188ff02bbe25c28926e9968/8d565/photo.webp 240w,/static/44654e347188ff02bbe25c28926e9968/21b1a/photo.webp 480w,/static/44654e347188ff02bbe25c28926e9968/d6f60/photo.webp 960w" sizes="(min-width: 960px) 960px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 960px) 960px, 100vw" decoding="async" loading="lazy" data-src="/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png" data-srcset="/static/44654e347188ff02bbe25c28926e9968/87351/photo.png 240w,/static/44654e347188ff02bbe25c28926e9968/ec333/photo.png 480w,/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png 960w" alt="Adrian Pietrzak"/></picture><noscript><picture><source type="image/avif" srcSet="/static/44654e347188ff02bbe25c28926e9968/7234b/photo.avif 240w,/static/44654e347188ff02bbe25c28926e9968/0f4b9/photo.avif 480w,/static/44654e347188ff02bbe25c28926e9968/c42ce/photo.avif 960w" sizes="(min-width: 960px) 960px, 100vw"/><source type="image/webp" srcSet="/static/44654e347188ff02bbe25c28926e9968/8d565/photo.webp 240w,/static/44654e347188ff02bbe25c28926e9968/21b1a/photo.webp 480w,/static/44654e347188ff02bbe25c28926e9968/d6f60/photo.webp 960w" sizes="(min-width: 960px) 960px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 960px) 960px, 100vw" decoding="async" loading="lazy" src="/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png" srcSet="/static/44654e347188ff02bbe25c28926e9968/87351/photo.png 240w,/static/44654e347188ff02bbe25c28926e9968/ec333/photo.png 480w,/static/44654e347188ff02bbe25c28926e9968/3f279/photo.png 960w" alt="Adrian Pietrzak"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="Author-module--wrapper--5b181"><strong>Adrian Pietrzak</strong><div class="Meta-module--meta--dae0a"><p>Aug 29, 2021</p><span>â€”</span><p>7<!-- --> min read</p></div></div></div></div><div class="Content-module--body--726c2"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6e4d9e5ea69d6824f2b97db97a897aa2/e5166/thumbnail.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCBAb/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAXCt1maIFcWf/8QAGhABAAIDAQAAAAAAAAAAAAAAAQIDAAQRE//aAAgBAQABBQLss3r3JcUOCE7bl9P/xAAYEQACAwAAAAAAAAAAAAAAAAAAAgERIf/aAAgBAwEBPwF2ohcP/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BJ//EAB0QAAIBBAMAAAAAAAAAAAAAAAABAgMQESFBUaH/2gAIAQEABj8C5FTi8dm4e2bltjP/xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhMUFRkaH/2gAIAQEAAT8hW1dBC2Zv4WUj5CIFoSNIzKsH/9oADAMBAAIAAwAAABBAL//EABgRAQEAAwAAAAAAAAAAAAAAAAEAESGx/9oACAEDAQE/EAG5kOe3/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/EBq//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBYZHB/9oACAEBAAE/EB1YPAuIEKjnDs+vUdXMHTBw0Cjbm5IFXmOBxQMMJ//Z'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6e4d9e5ea69d6824f2b97db97a897aa2/8ac56/thumbnail.webp 240w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/d3be9/thumbnail.webp 480w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/e46b2/thumbnail.webp 960w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/92f8c/thumbnail.webp 1200w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/6e4d9e5ea69d6824f2b97db97a897aa2/09b79/thumbnail.jpg 240w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/7cc5e/thumbnail.jpg 480w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/6a068/thumbnail.jpg 960w,
/static/6e4d9e5ea69d6824f2b97db97a897aa2/e5166/thumbnail.jpg 1200w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/jpeg"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6e4d9e5ea69d6824f2b97db97a897aa2/6a068/thumbnail.jpg"
            alt="Thumbnail"
            title="Thumbnail"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<blockquote>
<p><strong>Note</strong>: The below article is applicable to TypeORM in version 0.2.37 (released on 08/13/2021). Before reading, check if there is already a new version with a solution to this issue: <a href="https://github.com/typeorm/typeorm/releases" target="_blank" rel="nofollow noopener noreferrer">github.com/typeorm/typeorm/releases</a></p>
</blockquote>
<p>Among Node.js developers there is a constant struggle to choose the best ORM library. I most often choose TypeORM in my projects and althoughÂ I think it is the best ORM, it has its drawbacks.</p>
<p>In todayâ€™s article, Iâ€™ll show you how you can stupidly make a huge mistake and let your application be hacked by accidentally granting root access. It may sound spicy, <strong>but it is</strong>! ðŸŒ¶</p>
<p>For the purposes of this article, I have prepared a simple application using Nest.js framework with user authorization and access roles. You can find the repository with source code <a href="https://github.com/pietrzakadrian/nestjs-typeorm-findone" target="_blank" rel="nofollow noopener noreferrer">here</a>.</p>
<hr>
<h2 id="general-problem" style="position:relative;"><a href="#general-problem" aria-label="general problem permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>General problem</h2>
<p>The problem applies to the functionÂ <code class="language-text">.findOne()</code> available in the entity repository. Most CRUD applications use this method. Itâ€™s about searching forÂ a record.</p>
<p>When you pass <code class="language-text">null</code> or <code class="language-text">undefined</code> to the argument, <strong>you always get the first result in the table as a result</strong>!</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../entities/user.entity"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserRepository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../repositories/user.repository"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> _userRepository<span class="token operator">:</span> UserRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserEntity<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_userRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The contributors of the library are well aware of this problem. This is where the discussion takes place: <a href="https://github.com/typeorm/typeorm/issues/2500" target="_blank" rel="nofollow noopener noreferrer">#2500</a>. On 16 May 2020, @pleerock <a href="https://github.com/typeorm/typeorm/issues/2500#issuecomment-629549738" target="_blank" rel="nofollow noopener noreferrer">wrote</a> the following comment:</p>
<blockquote>
<p>Since this is a breaking, fix will be available in the next branch.</p>
</blockquote>
<p>Unfortunately, after more than a year, in spite of the release of newer versions, the bug still has not been fixed. It doesnâ€™t look good. ðŸ˜</p>
<hr>
<h2 id="why-is-it-dangerous-to-your-nodejs-application" style="position:relative;"><a href="#why-is-it-dangerous-to-your-nodejs-application" aria-label="why is it dangerous to your nodejs application permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why is it dangerous to your Node.js application?</h2>
<p>TheÂ <code class="language-text">.findOne()</code> function with the argument <code class="language-text">null</code> or <code class="language-text">undefined</code> will execute the following SQL query:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_id"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"firstName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_firstName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"lastName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_lastName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"username"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_username"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"password"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_password"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"role"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_role"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"createdAt"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_createdAt"</span>
<span class="token keyword">FROM</span>
	<span class="token string">"users"</span> <span class="token string">"UserEntity"</span>
<span class="token keyword">LIMIT</span> <span class="token number">1</span></code></pre></div>
<p>As you can see, there is no <code class="language-text">WHERE</code> statement. This means it will return the first result from the table.<br>
And do you know who the first user in the database is usually?</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"firstName"</span><span class="token operator">:</span> <span class="token string">"Adrian"</span><span class="token punctuation">,</span>
  <span class="token property">"lastName"</span><span class="token operator">:</span> <span class="token string">"Pietrzak"</span><span class="token punctuation">,</span>
  <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"contact@pietrzakadrian.com"</span><span class="token punctuation">,</span>
  <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"$2b$10$93pNQaRzK4JxddXLawC98euwXDNXocOh0hHVbatO1Up0DWJCBjOzK"</span><span class="token punctuation">,</span>
  <span class="token property">"role"</span><span class="token operator">:</span> <span class="token string">"ADMIN_ROLE"</span><span class="token punctuation">,</span>
  <span class="token property">"createdAt"</span><span class="token operator">:</span> <span class="token string">"2021-08-27T09:02:47.661Z"</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Yes, this is an administrator account. ðŸ˜³</p>
<hr>
<h2 id="how-can-this-software-be-hacked" style="position:relative;"><a href="#how-can-this-software-be-hacked" aria-label="how can this software be hacked permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How can this software be hacked?</h2>
<p>If you are programming in TypeScript, the chance of making this mistake is impossible. ðŸ’™<br>
However, most node.js applications are written in JavaScript, which does not care about the proper and existing types. Now I will show you how to make a mistake that will cost us a lot.</p>
<p>Look, this is what my JWT token looks like with a logged in user:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsImlhdCI6MTYzMDA1NTA0MCwiZXhwIjoxNjMwMDU4NjQwfQ.rlNavGjpS4x-_AgL5CwZvhpmMi50FJm7Rp-PK6_d-0Y</code></pre></div>
<p>It contains the following structure after decoding:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"userId"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1630055040</span><span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1630058640</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p><strong>Note</strong>: The user with id <strong>2</strong> is a regular user with the <code class="language-text">USER_ROLE</code> role.</p>
</blockquote>
<p>Now, after logging in, I want to call the controller to receive data about me:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Req<span class="token punctuation">,</span> UseGuards <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Roles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/auth/decorators/roles.decorator"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> JwtAuthenticationGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/auth/guards/jwt-authentication.guard"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RolesGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/auth/guards/roles.guard"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RequestWithUser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/auth/interfaces/request-with-user.interface"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RoleType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../constants/role-type.constant"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../entities/user.entity"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">"Users"</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Roles</span></span><span class="token punctuation">(</span>RoleType<span class="token punctuation">.</span><span class="token constant">ADMIN</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UseGuards</span></span><span class="token punctuation">(</span>JwtAuthenticationGuard<span class="token punctuation">,</span> RolesGuard<span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Req</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token operator">:</span> RequestWithUser<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserEntity<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> request<span class="token punctuation">.</span>user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This controller is only available for the <code class="language-text">ADMIN_ROLE</code> role. Decorators in TypeScript are read from bottom to top, so first I am using the JWT authentication guard which is written like this:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/passport"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthenticationGuard</span> <span class="token keyword">extends</span> <span class="token class-name">AuthGuard</span><span class="token punctuation">(</span><span class="token string">"jwt"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<p>This is related to the following strategy:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ConfigService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/config"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PassportStrategy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/passport"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"express"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ExtractJwt<span class="token punctuation">,</span> Strategy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"passport-jwt"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/user/entities/user.entity"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"src/user/services/user.service"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">JwtStrategy</span> <span class="token keyword">extends</span> <span class="token class-name">PassportStrategy</span><span class="token punctuation">(</span>Strategy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> configService<span class="token operator">:</span> ConfigService<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      jwtFromRequest<span class="token operator">:</span> ExtractJwt<span class="token punctuation">.</span><span class="token function">fromExtractors</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">(</span>request<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> request<span class="token operator">?.</span>cookies<span class="token operator">?.</span>Authentication<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      secretOrKey<span class="token operator">:</span> configService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"JWT_SECRET"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param payload here is the decoded data from JWT token, e.g. { userId: 2, ... }
   */</span>
  <span class="token keyword">async</span> <span class="token function">validate</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserEntity<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>As you can see, I use theÂ <code class="language-text">.getUserById(payload)</code> method to verify the user by the id encrypted in the token. Iâ€™m passing a payload object and trying to find a user for <code class="language-text">payload.id</code>. <strong>Such a key does not exist in the object!</strong> The user id is in the <code class="language-text">payload.userId</code> key, so <code class="language-text">payload.id</code> <strong>is undefined</strong>!</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../entities/user.entity"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserRepository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../repositories/user.repository"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> _userRepository<span class="token operator">:</span> UserRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserEntity<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>

    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_userRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="curl"><pre class="language-curl"><code class="language-curl">curl --location --request GET &#39;http://localhost:3000/users&#39; \
--header &#39;Content-Type: application/json&#39; \
--header &#39;Cookie: Authentication=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsImlhdCI6MTYzMDA1NTA0MCwiZXhwIjoxNjMwMDU4NjQwfQ.rlNavGjpS4x-_AgL5CwZvhpmMi50FJm7Rp-PK6_d-0Y&#39;</code></pre></div>
<blockquote>
<p><strong>Note</strong>: You can decode this JWT token yourself here: <a href="https://jwt.io" target="_blank" rel="nofollow noopener noreferrer">https://jwt.io</a></p>
</blockquote>
<p>This will perform the SQL operation:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_id"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"firstName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_firstName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"lastName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_lastName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"username"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_username"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"password"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_password"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"role"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_role"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"createdAt"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_createdAt"</span>
<span class="token keyword">FROM</span>
	<span class="token string">"users"</span> <span class="token string">"UserEntity"</span>
<span class="token keyword">LIMIT</span> <span class="token number">1</span></code></pre></div>
<p>And we get the same result as above:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"firstName"</span><span class="token operator">:</span> <span class="token string">"Adrian"</span><span class="token punctuation">,</span>
  <span class="token property">"lastName"</span><span class="token operator">:</span> <span class="token string">"Pietrzak"</span><span class="token punctuation">,</span>
  <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"contact@pietrzakadrian.com"</span><span class="token punctuation">,</span>
  <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"$2b$10$93pNQaRzK4JxddXLawC98euwXDNXocOh0hHVbatO1Up0DWJCBjOzK"</span><span class="token punctuation">,</span>
  <span class="token property">"role"</span><span class="token operator">:</span> <span class="token string">"ADMIN_ROLE"</span><span class="token punctuation">,</span>
  <span class="token property">"createdAt"</span><span class="token operator">:</span> <span class="token string">"2021-08-27T09:02:47.661Z"</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I am logged in as user with id = <strong>1</strong> and now I have access to all controllers with the <code class="language-text">ADMIN_ROLE</code> role! ðŸŽ‰ðŸ¤¯</p>
<hr>
<h2 id="how-to-fix-this-threat" style="position:relative;"><a href="#how-to-fix-this-threat" aria-label="how to fix this threat permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to fix this threat?</h2>
<p><strong>Stop usingÂ <code class="language-text">.findOne()</code> directly from the repository!</strong> This is convenient, but you donâ€™t have complete control over the SQL queries. Instead, always make your queries withÂ <code class="language-text">.createQueryBuilder()</code>:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nestjs/common"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../entities/user.entity"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserRepository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../repositories/user.repository"</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> _userRepository<span class="token operator">:</span> UserRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserEntity<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_userRepository<span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    queryBuilder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"user.id = :id"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> queryBuilder<span class="token punctuation">.</span><span class="token function">getOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Even if you pass <code class="language-text">null</code> to the argument, the SQL will be properly formulated:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_id"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"firstName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_firstName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"lastName"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_lastName"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"username"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_username"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"password"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_password"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"role"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_role"</span><span class="token punctuation">,</span>
	<span class="token string">"UserEntity"</span><span class="token punctuation">.</span><span class="token string">"createdAt"</span> <span class="token keyword">AS</span> <span class="token string">"UserEntity_createdAt"</span>
<span class="token keyword">FROM</span>
	<span class="token string">"users"</span> <span class="token string">"UserEntity"</span>
<span class="token keyword">WHERE</span>
	<span class="token string">"user"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token operator">=</span> $<span class="token number">1</span> <span class="token comment">-- PARAMETERS: [null]</span></code></pre></div>
<p>This SQL operation will return an empty result, not the first record in the database. Now our code is completely safe. ðŸ”</p>
<hr>
<p>You can also find this article on <a href="https://medium.com/@pietrzakadrian" target="_blank" rel="nofollow noopener noreferrer">medium.com</a> where I share my solutions to the problems I encountered during my software engineer career.</p></div></div></div><div><div class="Copyright-module--copyright--766ee">Â© All rights reserved.</div></div><div class="Post-module--footer--f8705"><div class="Tags-module--tags--18589"><ul class="Tags-module--list--82ae6"><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/typescript/">TypeScript</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nodejs/">NodeJS</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/typeorm/">TypeORM</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nestjs/">NestJS</a></li></ul></div></div><div class="Post-module--comments--d3b99"><div></div></div><hr/><div><h2>Related articles</h2><section class="Related-module--related--75a7f"><div class="Feed-module--feed--a6204"><div class="Feed-module--item--c7a63"><div class="Feed-module--meta--250c2"><time class="Feed-module--time--72864" dateTime="February 13, 2022">February 13, 2022</time><span class="Feed-module--divider--81a18">â€”</span><small>21<!-- --> min read</small></div><h2 class="Feed-module--title--f252f"><a class="Feed-module--link--6123b" href="/blog/nestjs-authentication-series/user-registration">NestJS Authentication Series ðŸ”: Part 1 - User registration</a></h2><p class="Feed-module--description--57348">Welcome you to my blog series on user authentication in the NestJS framework. This series is a set of several tutorials that extend the official documentation. If you are programming an enterprise application, you will most likely want to include full user support, i.e. email account confirmation, password reminder capability, etc. This post is the first part in a series and below you can find a list of all the other articles on this topic.</p><div class="Feed-module--bottom--dd480"><div class="Feed-module--tags--75a26"><div class="Tags-module--tags--18589"><ul class="Tags-module--list--82ae6"><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/typescript/">TypeScript</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nodejs/">NodeJS</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nestjs/">NestJS</a></li></ul></div></div></div></div><div class="Feed-module--item--c7a63"><div class="Feed-module--meta--250c2"><time class="Feed-module--time--72864" dateTime="December 1, 2021">December 1, 2021</time><span class="Feed-module--divider--81a18">â€”</span><small>11<!-- --> min read</small></div><h2 class="Feed-module--title--f252f"><a class="Feed-module--link--6123b" href="/blog/how-to-create-a-microservice-that-handles-the-queue-of-sending-emails-in-nestjs">How to create a microservice that handles ðŸŽ¢ the queue of sending emails in NestJS</a></h2><p class="Feed-module--description--57348">In this article, I will present you independent microservice that handles the queue of sending emails using the Node.js platform with the NestJS framework. The use of this microservice allows you to decouple the business logic of the email senders from the main monolithic application, resulting in less use of server resources and therefore faster source code execution.</p><div class="Feed-module--bottom--dd480"><div class="Feed-module--tags--75a26"><div class="Tags-module--tags--18589"><ul class="Tags-module--list--82ae6"><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nodejs/">NodeJS</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/typescript/">TypeScript</a></li><li class="Tags-module--item--52015"><a class="Button-module--button--b1113 Tags-module--button--421f7" href="/blog/tag/nestjs/">NestJS</a></li></ul></div></div></div></div></div></section></div></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/how-to-hack-your-nodejs-application-which-uses-typeorm";window.___webpackCompilationHash="02a7d5c7e282970dd9d7";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-7b231fda57e6c8cb3788.js"],"app":["/app-5c20b449e13236bce12b.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0c915c7b1bdb5eac4fdf.js"],"component---src-templates-blog-template-blog-template-tsx":["/component---src-templates-blog-template-blog-template-tsx-2e5eac9a48ad4c64e6b4.js"],"component---src-templates-categories-template-categories-template-tsx":["/component---src-templates-categories-template-categories-template-tsx-e95e61bcac46a2493a97.js"],"component---src-templates-category-template-category-template-tsx":["/component---src-templates-category-template-category-template-tsx-878312bf11e7f86cf62a.js"],"component---src-templates-certifications-template-certifications-template-tsx":["/component---src-templates-certifications-template-certifications-template-tsx-576c0e955466ae0e83b2.js"],"component---src-templates-collaboration-template-collaboration-template-tsx":["/component---src-templates-collaboration-template-collaboration-template-tsx-c6d9334da1c16149a156.js"],"component---src-templates-home-template-home-template-tsx":["/component---src-templates-home-template-home-template-tsx-7a400f1de4d0f09c8628.js"],"component---src-templates-not-found-template-not-found-template-tsx":["/component---src-templates-not-found-template-not-found-template-tsx-ea68c7ff6de6afaebced.js"],"component---src-templates-page-template-page-template-tsx":["/component---src-templates-page-template-page-template-tsx-f4339b4ae2b8c66ab1fa.js"],"component---src-templates-post-template-post-template-tsx":["/component---src-templates-post-template-post-template-tsx-8fa5be1b5d15e1258ff7.js"],"component---src-templates-tag-template-tag-template-tsx":["/component---src-templates-tag-template-tag-template-tsx-fc683d449c01b8d4a04e.js"],"component---src-templates-tags-template-tags-template-tsx":["/component---src-templates-tags-template-tags-template-tsx-68309a9b42b11997ffc7.js"]};/*]]>*/</script><script src="/polyfill-7b231fda57e6c8cb3788.js" nomodule=""></script><script src="/app-5c20b449e13236bce12b.js" async=""></script><script src="/framework-745d5d28c0250a1a333b.js" async=""></script><script src="/webpack-runtime-5016701f166aaff95366.js" async=""></script></body></html>